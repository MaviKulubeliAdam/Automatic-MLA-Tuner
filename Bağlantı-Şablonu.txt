# MANYETİK LOOP AUTO-TUNER - DETAYLI BAĞLANTI ŞEMASI
# Tüm Sistem - Her Parça ve Kablo
# DDS: AD9851 (0-60+ MHz, Sinüs Çıkışı)

```
╔═══════════════════════════════════════════════════════════════════════════════╗
║                    MANYETİK LOOP AUTO-TUNER SİSTEM DİYAGRAMI                  ║
║                    v4.0 FINAL - AD9851 DDS İLE                                 ║
╚═══════════════════════════════════════════════════════════════════════════════╝


┌─────────────────────────────────────────────────────────────────────────────┐
│                          GÜÇ KAYNAKLARI                                      │
└─────────────────────────────────────────────────────────────────────────────┘

    ┌──────────────┐                 ┌──────────────┐
    │  12V/2A PSU  │                 │   5V/2A PSU  │
    │  (RF Amp)    │                 │  (Arduino)   │
    └──────┬───────┘                 └──────┬───────┘
           │                                │
      12V──┤                           5V──┤
      GND──┤                          GND──┤
           │                                │
           │                                │
           │         ORTAK GND              │
           └────────────┬───────────────────┘
                        │
                     ═══╪═══  (Ground Bus)
                        │


┌─────────────────────────────────────────────────────────────────────────────┐
│                     ANA KONTROLÖR - ARDUINO MEGA 2560                        │
└─────────────────────────────────────────────────────────────────────────────┘

                        ┌─────────────────────────┐
                        │   ARDUINO MEGA 2560     │
                        │                         │
    ┌───────────────────┤ VIN: 5V                 │
    │                   │ GND: GND (Common)       │
    │                   │                         │
    │  DDS KONTROL      │ Pin 51 (MOSI)   ────────┼────┐
    │  (SPI)            │ Pin 52 (SCK)    ────────┼────┼───┐
    │                   │ Pin 53 (SS)     ────────┼────┼───┼───┐
    │                   │ Pin 49          ────────┼────┼───┼───┼──┐
    │                   │                         │    │   │   │  │
    │  SWR ÖLÇÜM        │ A0 (Analog)     ────────┼────┼───┼───┼──┼──┐
    │  (AD8307)         │ A1 (Analog)     ────────┼────┼───┼───┼──┼──┼──┐
    │                   │                         │    │   │   │  │  │  │
    │  MOTOR            │ Pin 4 (STEP)    ────────┼────┼───┼───┼──┼──┼──┼──┐
    │  (TB6600)         │ Pin 3 (DIR)     ────────┼────┼───┼───┼──┼──┼──┼──┼──┐
    │                   │ Pin 9 (ENABLE)  ────────┼────┼───┼───┼──┼──┼──┼──┼──┼──┐
    │                   │                         │    │   │   │  │  │  │  │  │  │
    │  RF AMP           │ Pin 10 (RF_EN)  ────────┼────┼───┼───┼──┼──┼──┼──┼──┼──┼──┐
    │                   │                         │    │   │   │  │  │  │  │  │  │  │
    │  ENCODER          │ Pin 2 (CLK/INT) ────────┼────┼───┼───┼──┼──┼──┼──┼──┼──┼──┼──┐
    │                   │ Pin 5 (DT)      ────────┼────┼───┼───┼──┼──┼──┼──┼──┼──┼──┼──┼──┐
    │                   │ Pin 6 (SW)      ────────┼────┼───┼───┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┐
    │                   │                         │    │   │   │  │  │  │  │  │  │  │  │  │  │
    │  BUTONLAR         │ Pin 7 (BTN_FWD) ────────┼────┼───┼───┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┐
    │                   │ Pin 8 (BTN_REV) ────────┼────┼───┼───┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┐
    │                   │                         │    │   │   │  │  │  │  │  │  │  │  │  │  │  │  │
    │                   │ USB (PC Seri)   ═══════ USB  │   │   │  │  │  │  │  │  │  │  │  │  │  │  │
    │                   └─────────────────────────┘    │   │   │  │  │  │  │  │  │  │  │  │  │  │  │
    │                                                   │   │   │  │  │  │  │  │  │  │  │  │  │  │  │
    └───────────────────────────────────────────────────┘   │   │  │  │  │  │  │  │  │  │  │  │  │  │


┌─────────────────────────────────────────────────────────────────────────────┐
│                    DDS SİNYAL ÜRETİCİSİ - AD9851                             │
└─────────────────────────────────────────────────────────────────────────────┘

                    ┌────────────────────────────────────┐
                    │     AD9851 MODÜL (Üstten Görünüş)  │
                    ├────────────────────────────────────┤
                    │  GND   SMA  SINE  GND             │  ← Üst sıra (modüle göre değişir)
                    │  DATA  W_CLK  FQ_UD  RESET  VCC   │  ← Alt sıra (kontrol hatları)
                    └────────────────────────────────────┘

         Pin Açıklamaları:
         • VCC:   Arduino 5V        → Alt sıra
         • GND:   Arduino GND       → Üst/alt (herhangi biri)
         • DATA:  Arduino Pin 51    → Seri veri (LSB-first)
         • W_CLK: Arduino Pin 52    → Word Clock
         • FQ_UD: Arduino Pin 53    → Frequency Update
         • RESET: Arduino Pin 49    → Reset
         • SINE:  Sine OUT (pin header) → Alternatif RF çıkış
         • SMA:   RF çıkış ✓ (varsa modülde)

                        ┌──────────────────────┐
                            │    AD9851 Bağlantı   │
                        │    Şema Detayı       │
                        ├──────────────────────┤
            Arduino 5V ────────►│ VCC                  │
            Arduino GND ───────►│ GND                  │
                        │                      │
            Arduino Pin 51 ────►│ DATA                 │
            Arduino Pin 52 ────►│ W_CLK                │
            Arduino Pin 53 ────►│ FQ_UD                │
            Arduino Pin 49 ────►│ RESET                │
                        │                      │
                        ┌────┤ SMA Dişi (RF OUT)    │
                        │    │ (seviye modüle bağlı)│
                   │    │                      │
                        │    │ SINE OUT ────────────┼──┐ [Alternatif]
                   │    └──────────────────────┘  │
                   │                               │
                        │ RF OUT (50Ω, sinüs)           │
                   │ [Direkt kullanıma hazır!]     │
                   ▼                               ▼


┌─────────────────────────────────────────────────────────────────────────────┐
│              RF AMPLIFIER - 1MHz-3000MHz Çin Klonu                           │
└─────────────────────────────────────────────────────────────────────────────┘

                    ┌──────────────────────────────────┐
                    │  RF AMP MODÜL (Üstten Görünüş)   │
                    ├──────────────────────────────────┤
                    │  GND   VCC   RFOUT   RFIN       │  ← Pinler
                    └──────────────────────────────────┘

         Pin Açıklamaları:
         • VCC:   12V/2A güç      → Röle NO (Normally Open)
         • GND:   Toprak          → Ortak GND bus
         • RFIN:  RF girişi       → AD9851 SMA OUT
         • RFOUT: RF çıkışı       → 20dB Attenuator

         NOT: Enable pin YOK - Röle ile kontrol edilir!

                        ┌──────────────────────┐
                        │   RF AMPLIFIER       │
                        │   1MHz-3GHz          │
                        │   +20dB Kazanç       │
                        ├──────────────────────┤
    Röle NO ───────────►│ VCC (12V/2A)         │
    Ortak GND ─────────►│ GND                  │
                        │                      │
    AD9851 SMA ────────►│ RFIN (50Ω)           │
                        │ [SMA Dişi Konnektör] │
                        │                      │
                        │ RFOUT (50Ω) ─────────┼──┐
                        │ [SMA Dişi Konnektör] │  │
                        │ (~0.5-1W çıkış)      │  │
                        └──────────────────────┘  │
                                                  │
                                      RF Out (~1W, 50Ω)
                                                  │
                                                  ▼


┌─────────────────────────────────────────────────────────────────────────────┐
│                   5V RÖLE MODÜLÜ (RF Amp Kontrol)                            │
└─────────────────────────────────────────────────────────────────────────────┘

                    ┌──────────────────────────────────┐
                    │   5V RÖLE MODÜL (Üstten Görünüş) │
                    ├──────────────────────────────────┤
                    │  VCC  GND  IN   NC  COM  NO     │  ← Pinler
                    └──────────────────────────────────┘

         Pin Açıklamaları:
         • VCC: Arduino 5V        → Röle güç kaynağı
         • GND: Arduino GND       → Ortak toprak
         • IN:  Arduino Pin 10    → Kontrol sinyali (aktif LOW)
         • NC:  Normally Closed   → Kullanılmıyor
         • COM: Common            → 12V PSU pozitif
         • NO:  Normally Open     → RF Amp VCC

                        ┌──────────────────────┐
                        │   5V RÖLE MODÜLÜ     │
                        │   (1 Kanal)          │
                        ├──────────────────────┤
    Arduino 5V ────────►│ VCC                  │
    Arduino GND ───────►│ GND                  │
                        │                      │
    Arduino Pin 10 ────►│ IN (Kontrol)         │
                        │                      │
    12V PSU (+) ───────►│ COM (Ortak)          │
                        │                      │
                        │ NO (N.Open) ─────────┼──► RF Amp VCC
                        │                      │
                        │ NC (N.Closed) [Boş]  │
                        └──────────────────────┘

         ÇALIŞMA PRENSİBİ:
         ┌─────────────────┬──────────────┬─────────────┐
         │ Pin 10 Durumu   │ Röle Durumu  │ RF Amp      │
         ├─────────────────┼──────────────┼─────────────┤
         │ HIGH (5V)       │ KAPALI       │ GÜÇ YOK ❌  │
         │ LOW (0V)        │ AÇIK         │ ÇALIŞIR ✓   │
         └─────────────────┴──────────────┴─────────────┘

         NOT: Çoğu röle modülü AKTIF LOW çalışır!
              Kodda digitalWrite(RF_AMP_ENABLE, LOW) → Amp AÇIK
              digitalWrite(RF_AMP_ENABLE, HIGH) → Amp KAPALI


┌─────────────────────────────────────────────────────────────────────────────┐
│                  20dB ATTENUATOR (Güvenlik için)                             │
└─────────────────────────────────────────────────────────────────────────────┘

                            ┌──────────┐
    RF Amp OUT (1W) ───────►│   -20dB  │
                            │  Atten.  │
                            │  (50Ω)   │
                            └────┬─────┘
                                 │
                      ~10mW (Güvenli seviye)
                                 │
                                 ▼


┌─────────────────────────────────────────────────────────────────────────────┐
│                    SWR BRIDGE - T50-2 Toroid                                 │
└─────────────────────────────────────────────────────────────────────────────┘

                        ┌──────────────────────┐
                        │    SWR BRIDGE        │
                        │    T50-2 Toroid      │
                        │                      │
    Attenuator ────────►│ INPUT (50Ω)          │
                        │                      │
                        │  ┌────────────┐      │
                        │  │  T50-2     │      │
                        │  │  10T Pri   │      │
                        │  │  2T FWD ───┼──────┼─┐  FWD Sample
                        │  │  2T REF ───┼──────┼─┼─┐  REF Sample
                        │  └────────────┘      │ │ │
                        │                      │ │ │
                        │ OUTPUT (50Ω) ────────┼─┼─┼──► ANTEN
                        └──────────────────────┘ │ │
                                                 │ │
                                    FWD Sample ──┘ │
                                    REF Sample ────┘


┌─────────────────────────────────────────────────────────────────────────────┐
│              RF DEDEKTÖRLER - AD8307 (x2 Adet)                               │
└─────────────────────────────────────────────────────────────────────────────┘

    ┌─────────────────────────┐         ┌─────────────────────────┐
    │   AD8307 #1 (FORWARD)   │         │  AD8307 #2 (REFLECTED)  │
    │   Logarithmic Detector  │         │  Logarithmic Detector   │
    ├─────────────────────────┤         ├─────────────────────────┤
    │ VCC: 5V                 │         │ VCC: 5V                 │
    │ GND: GND                │         │ GND: GND                │
    │                         │         │                         │
FWD►│ IN: FWD Sample          │     REF►│ IN: REF Sample          │
    │                         │         │                         │
    │ OUT: DC Voltage ────────┼──┐      │ OUT: DC Voltage ────────┼──┐
    │      (0-2.5V)           │  │      │      (0-2.5V)           │  │
    └─────────────────────────┘  │      └─────────────────────────┘  │
                                 │                                   │
                            A0 ──┘                              A1 ──┘
                       (Arduino Mega)                     (Arduino Mega)

    ══════════════════════════════════════════════════════════════════════════════
      OPSİYONEL: AD8307 VOUT - SMA DİŞİ TEST PORTU
    ══════════════════════════════════════════════════════════════════════════════

    Amaç:
        • AD8307 DC çıkışını (VOUT, ~0–2.5V) dışarıdan güvenli şekilde ölçmek.

    Konnektör:
        • Panel tipi SMA dişi: Merkez pim = sinyal, gövde/dişler = GND.

    Bağlantı Şeması:
        AD8307 OUT (VOUT) ──[1k seri direnç]──► SMA Merkez Pim
        GND ──────────────────────────────────► SMA Gövde (Shield)
        (Opsiyonel) 100nF kondansatör: Merkez pimden GND’ye (HF gürültü filtresi)

    Topoloji (T bağlantı):
        AD8307 OUT ──┬──► Arduino A0/A1 (yüksek empedans okuma)
                      └──[1k]──► SMA Test Portu (koruma/ESD önlemi)

    Kablo:
        • Kısa RG174/ince koaks kullan (<15 cm). Shield’ı ortak GND bus’a bağla.

    Ölçüm Cihazı:
        • 1 MΩ girişli osiloskop/voltmetre ile ölç (DC hat!).
        • 50 Ω terminasyon kullanma; çıkışı aşırı yükler ve okuma hatalı olur.

    Notlar:
        • Bu hat RF değil; sadece DC/logaritmik seviye ölçümü için.
        • Harici ESD’ye karşı seri 1k + TVS diyot (opsiyonel) eklenebilir.


┌─────────────────────────────────────────────────────────────────────────────┐
│                   STEP MOTOR DRIVER - TB6600                                 │
└─────────────────────────────────────────────────────────────────────────────┘

                        ┌──────────────────────┐
                        │      TB6600          │
                        │   Step Driver        │
                        ├──────────────────────┤
    Pin 4 ─────────────►│ PUL- (Step)          │
    Pin 3 ─────────────►│ DIR- (Direction)     │
    Pin 9 ─────────────►│ ENA- (Enable)        │
                        │                      │
    5V ────────────────►│ PUL+ (5V)            │
    5V ────────────────►│ DIR+ (5V)            │
    5V ────────────────►│ ENA+ (5V)            │
                        │                      │
    12-24V ────────────►│ VCC (Motor Power)    │
    GND ────────────────┤ GND                  │
                        │                      │
                        │ A+, A- ──────────────┼──┐
                        │ B+, B- ──────────────┼──┼──► STEP MOTOR
                        └──────────────────────┘  │
                                                  │
                                                  ▼


┌─────────────────────────────────────────────────────────────────────────────┐
│                      STEP MOTOR - NEMA 17                                    │
└─────────────────────────────────────────────────────────────────────────────┘

                        ┌──────────────────────┐
                        │    STEP MOTOR        │
                        │    NEMA 17           │
    TB6600 A+ ─────────►│ Coil A+              │
    TB6600 A- ─────────►│ Coil A-              │
    TB6600 B+ ─────────►│ Coil B+              │
    TB6600 B- ─────────►│ Coil B-              │
                        │                      │
                        │ Motor Şaft ──────────┼──► Vakum Kapasitör
                        └──────────────────────┘      (Mekanik)


┌─────────────────────────────────────────────────────────────────────────────┐
│                   KULLANICI ARAYÜZLERİ                                       │
└─────────────────────────────────────────────────────────────────────────────┘

    ┌──────────────────┐              ┌─────────────────┐
    │  ROTARY ENCODER  │              │  PUSH BUTONLAR  │
    ├──────────────────┤              ├─────────────────┤
    │ CLK ─────► Pin 2 │              │ BTN_FWD ─► Pin 7│
    │ DT  ─────► Pin 5 │              │ BTN_REV ─► Pin 8│
    │ SW  ─────► Pin 6 │              │ GND ────────GND │
    │ GND ─────── GND  │              └─────────────────┘
    │ +5V ─────── 5V   │
    └──────────────────┘

    ┌──────────────────┐
    │   PC / LAPTOP    │
    │                  │
    │  Serial Monitor  │
    │  (115200 baud)   │
    └────────┬─────────┘
             │
         USB Kablo
             │
             ▼
    Arduino Mega USB Port


┌─────────────────────────────────────────────────────────────────────────────┐
│                     ÇIKIŞ - LOOP ANTEN                                       │
└─────────────────────────────────────────────────────────────────────────────┘

                        ┌──────────────────────┐
                        │   LOOP ANTEN         │
                        │   (Manyetik Loop)    │
    SWR Bridge OUT ────►│ Besleme Noktası      │
                        │                      │
    Motor Şaft ────────►│ Vakum Kapasitör      │
                        │ (Ayar Mekanizması)   │
                        └──────────────────────┘


┌═════════════════════════════════════════════════════════════════════════════┐
║                         DETAYLI KABLO BAĞLANTILARI                           ║
╚═════════════════════════════════════════════════════════════════════════════╝


══════════════════════════════════════════════════════════════════════════════
  GÜÇ DAĞITIMI (POWER DISTRIBUTION)
══════════════════════════════════════════════════════════════════════════════

[12V/2A PSU] ──┬─── 12V ───► [RF Amplifier VCC]
               │
               └─── GND ──┐
                          │
[5V/2A PSU]  ──┬─── 5V ───┼──► [Arduino Mega VIN]
               │          │
               │          ├──► [AD9851 VCC]
               │          │
               │          ├──► [AD8307 #1 VCC]
               │          │
               │          ├──► [AD8307 #2 VCC]
               │          │
               │          ├──► [TB6600 PUL+/DIR+/ENA+]
               │          │
               │          ├──► [Encoder VCC]
               │          │
               └─── GND ──┼──► [ORTAK GND BUS]
                          │
[Motor PSU 24V]───── GND ─┤
                          │
                      ════╧════ (Common Ground)


══════════════════════════════════════════════════════════════════════════════
    DDS KONTROL (Arduino ↔ AD9851)
══════════════════════════════════════════════════════════════════════════════
Arduino Pin 51 ────[Kablo]───► AD9851 DATA
Arduino Pin 52 ────[Kablo]───► AD9851 W_CLK
Arduino Pin 53 ────[Kablo]───► AD9851 FQ_UD
Arduino Pin 49 ────[Kablo]───► AD9851 RESET
Arduino 5V      ────[Kablo]───► AD9851 VCC
Arduino GND     ────[Kablo]───► AD9851 GND


══════════════════════════════════════════════════════════════════════════════
  ANALOG ÖLÇÜM (Arduino ↔ AD8307)
══════════════════════════════════════════════════════════════════════════════

AD8307 #1 OUT (DC 0-2.5V) ────[Kablo]───► Arduino A0 (FWD Power)
AD8307 #2 OUT (DC 0-2.5V) ────[Kablo]───► Arduino A1 (REF Power)


══════════════════════════════════════════════════════════════════════════════
  MOTOR KONTROL (Arduino ↔ TB6600)
══════════════════════════════════════════════════════════════════════════════

Arduino Pin 4 ────[Kablo]───► TB6600 PUL- (Step Pulses)
Arduino Pin 3 ────[Kablo]───► TB6600 DIR- (Direction)
Arduino Pin 9 ────[Kablo]───► TB6600 ENA- (Enable/Disable)

Arduino 5V ───┬──[Kablo]───► TB6600 PUL+ (Pull-up)
              ├──[Kablo]───► TB6600 DIR+ (Pull-up)
              └──[Kablo]───► TB6600 ENA+ (Pull-up)


══════════════════════════════════════════════════════════════════════════════
  RF ZİNCİRİ (Signal Path)
══════════════════════════════════════════════════════════════════════════════

AD9851 SMA Dişi Konnektör (sinüs, 50Ω; seviye modüle bağlı)
    │
    │ [Direkt bağlantı - Balun/Transformer gerekmez!]
    │
    │ [SMA Erkek-Erkek Koaksiyel Kablo - RG174]
    │ (veya SMA Erkek → RF Amp IN)
    ▼
RF Amplifier IN (SMA Dişi)

ALTERNATİF: SINE OUT Pin Kullanımı
    AD9851 SINE OUT (pin header)
        │
        │ [Jumper kablo veya ince tel]
        │ [BNC adaptör eklenebilir]
        ▼
    RF Amplifier IN

ÖNERİ: SMA konnektörü kullan (daha iyi kalkan ve empedans)
    │
    │ [Amplification +20dB]
    │
RF Amplifier OUT (~1W, 50Ω)
    │
    │ [50Ω Koaksiyel Kablo]
    │
    ▼
20dB Attenuator IN
    │
    │ [Attenuation -20dB]
    │
20dB Attenuator OUT (~10mW)
    │
    │ [50Ω Koaksiyel Kablo]
    │
    ▼
SWR Bridge INPUT
    │
    ├─── FWD Sample ──► AD8307 #1 IN
    │
    ├─── REF Sample ──► AD8307 #2 IN
    │
SWR Bridge OUTPUT
    │
    │ [50Ω Koaksiyel Kablo]
    │
    ▼
LOOP ANTEN (Manyetik Loop)


══════════════════════════════════════════════════════════════════════════════
  KULLANICI GİRİŞLERİ
══════════════════════════════════════════════════════════════════════════════

[Rotary Encoder]
    CLK ────[Kablo]───► Arduino Pin 2 (Interrupt)
    DT  ────[Kablo]───► Arduino Pin 5
    SW  ────[Kablo]───► Arduino Pin 6 (Pullup dahili)
    VCC ────[Kablo]───► Arduino 5V
    GND ────[Kablo]───► Arduino GND

[Push Buton İleri]
    Pin 1 ──[Kablo]───► Arduino Pin 7 (Pullup dahili)
    Pin 2 ──[Kablo]───► Arduino GND

[Push Buton Geri]
    Pin 1 ──[Kablo]───► Arduino Pin 8 (Pullup dahili)
    Pin 2 ──[Kablo]───► Arduino GND


══════════════════════════════════════════════════════════════════════════════
  RF AMPLIFIER KONTROL (RÖLE MODÜLÜ)
══════════════════════════════════════════════════════════════════════════════

Röle Modül Bağlantıları:
    Arduino 5V  ────[Kablo]───► Röle VCC
    Arduino GND ────[Kablo]───► Röle GND
    Arduino Pin 10 ──[Kablo]───► Röle IN (Kontrol)
    
    12V PSU (+) ────[Kablo]───► Röle COM (Ortak)
    Röle NO (N.Open) ─[Kablo]───► RF Amp VCC
    Röle NC ───────────────── [Boş bırakılır]

KONTROL MANTİĞI (AKTİF LOW):
    ┌─────────────────┬──────────────┬─────────────┐
    │ Pin 10 Durumu   │ Röle Durumu  │ RF Amp      │
    ├─────────────────┼──────────────┼─────────────┤
    │ HIGH (5V)       │ KAPALI       │ GÜÇ YOK ❌  │
    │ LOW (0V)        │ AÇIK         │ ÇALIŞIR ✓   │
    └─────────────────┴──────────────┴─────────────┘

KODDA KULLANIM:
    digitalWrite(RF_AMP_ENABLE, LOW);   // RF Amp AÇIK
    digitalWrite(RF_AMP_ENABLE, HIGH);  // RF Amp KAPALI

ÖNEMLİ NOT:
    • Çoğu 5V röle modülü AKTİF LOW çalışır!
    • Röle modülü üzerinde LED olur (kontrol için)
    • Röle ile 12V/2A güç güvenle açılır/kapatılır
    • Mekanik röle "tik" sesi yapar


══════════════════════════════════════════════════════════════════════════════
  MEKANIK BAĞLANTI
══════════════════════════════════════════════════════════════════════════════

Step Motor Şaft
    │
    │ [Flexible Coupling veya Kayış]
    │
    ▼
Vakum Kapasitör Şaftı (Loop Anten Tune)


╔═════════════════════════════════════════════════════════════════════════════╗
║                          KABLO UZUNLUKLARI                                   ║
╚═════════════════════════════════════════════════════════════════════════════╝

RF Kabloları (50Ω Koaksiyel):
    • AD9851 SMA → RF Amp:    15cm (SMA Erkek-Erkek, RG174)
    • RF Amp → Attenuator:    15cm (RG174)
    • Alternatif: SINE OUT → RF Amp: 10cm (jumper kablo - önerilmez)
    • Attenuator → SWR Bridge: 15cm (RG174)
    • SWR Bridge → Anten:     50cm-1m (RG58 veya RG213)

Güç Kabloları:
    • 12V PSU → RF Amp:       30cm (18AWG, kırmızı/siyah)
    • 5V PSU → Arduino:       20cm (USB veya Jack)
    • Arduino 5V dağıtım:     20cm her modül için

Sinyal Kabloları:
    • Arduino → AD9851:       15cm (Dupont jumper 4 adet: DATA,W_CLK,FQ_UD,RESET)
    • Arduino → AD8307:       20cm (Dupont jumper 2 adet)
    • Arduino → Röle Modül:   15cm (Dupont jumper 3 adet: VCC,GND,IN)
    • GND ve VCC:             15cm (Dupont jumper, AD9851 güç)
    • Arduino → TB6600:       25cm (Dupont jumper 3 adet)
    • Arduino → Encoder:      20cm (Dupont jumper 5 adet)
    • Arduino → Butonlar:     30cm (2 telli kablo, 2 adet)

RF Sample Kabloları:
    • SWR Bridge → AD8307:    10cm (RG174 veya ince koax)


╔═════════════════════════════════════════════════════════════════════════════╗
║                         KONNEKTÖR TİPLERİ                                    ║
╚═════════════════════════════════════════════════════════════════════════════╝

RF Bağlantıları:
    • SMA (önerilen) - Kompakt, 18GHz'e kadar
    • BNC (alternatif) - Kolay takma/çıkarma
    • SO239/PL259 - Anten bağlantısı için

Güç Bağlantıları:
    • DC Jack (2.1mm) - PSU'lar için
    • XT60 veya Screw Terminal - Motor gücü için
    • USB Type-B - Arduino programlama

Sinyal Bağlantıları:
    • 2.54mm Pin Header - Arduino pinleri
    • Dupont Jumper Kablolar - Kolay test
    • JST-XH Konnektörler - Kalıcı montaj için


╔═════════════════════════════════════════════════════════════════════════════╗
║                      AD9851 ÇIKIŞ BAĞLANTISI                                 ║
╚═════════════════════════════════════════════════════════════════════════════╝

AD9851 modülünde 2 farklı RF çıkışı bulunabilir (modüle göre):

SEÇENEK 1: SMA DİŞİ KONNEKTÖR (Önerilen ✓)
    ┌────────────┐
    │  AD9851    │     [SMA Erkek-Erkek]
    │            │     [Koaksiyel Kablo]
    │ [SMA Dişi] ┼═══════════════════► RF Amp IN
    │            │     (RG174, 15cm)
    │ GND ───────┼──► GND
    │            │
    └────────────┘
    
    ✓ En iyi yöntem!
    ✓ 50Ω empedans koruması
    ✓ RF kalkanlaması mükemmel
    ✓ Tak-çalıştır

SEÇENEK 2: SINE OUT PİNİ (Alternatif)
    ┌────────────┐
    │  AD9851    │
    │            │     [Jumper kablo]
    │ SINE OUT ──┼────────────► RF Amp IN
    │            │     (ince tel 10-15cm)
    │ GND ───────┼──► GND
    │            │
    └────────────┘
    
    • Test için kullanılabilir
    • Empedans uyumsuzluğu olabilir
    • Uzun mesafelerde sinyal kaybı
    • RF parazit alabilir

Notlar:
    • RF seviye modül tasarımına bağlıdır (tipik sinüs çıkışı).
    • 50Ω empedans hedeflenir.
    • HF için uygundur; ek LPF ile harmonikler azaltılabilir.

OPSİYONEL: RC Filtre (Harmonik Azaltma)
    ┌────────────┐
    │  AD9851    │         100Ω     100pF
    │            │          ┌─┐      ┌─┐
    │ VOUT ──────┼─────────┤ ├──┬───┤ ├─── RF Amp IN
    │            │          └─┘  │   └─┘
    │ GND ───────┼──────────┬────┴───GND
    │            │          │
    └────────────┘         GND
    
    • 3. harmonik bastırma
    • Daha temiz sinüs
    • Çoğu uygulamada gereksiz
    • SINE OUT veya SMA hattında opsiyonel kullanılabilir

AD9851 vs AD9833 KARŞILAŞTIRMA:
    ┌────────────────┬──────────────┬──────────────┐
    │  Özellik       │   AD9833     │   AD9851     │
    ├────────────────┼──────────────┼──────────────┤
    │ Frekans Max    │  12.5 MHz    │  60+ MHz     │
    │ Çıkış Tipi     │  Single-end  │  Diferansiyel│
    │ Çıkış Gücü     │  600mV p-p   │  200mW p-p   │
    │ Balun Gerekli? │  HAYIR ✓     │  Evet/Tercih │
    │ Güç Tüketimi   │  15mA        │  380mA       │
    │ Pin Sayısı     │  3 (SPI)     │  4 (Parallel)│
    │ Bağlantı       │  Çok Kolay ✓ │  Karmaşık    │
    │ HF için        │  İdeal ✓     │  İyi         │
    └────────────────┴──────────────┴──────────────┘

ÖNERİ: AD9851 kullan - Tüm HF + 6 m kapsaması, projeye uygun!

╔═════════════════════════════════════════════════════════════════════════════╗
║          TRANSCEIVER ENTEGRASYONU - HARİCİ TELSİZ BAĞLANTISI                ║
╚═════════════════════════════════════════════════════════════════════════════╝

Amaç:
    İç DDS zinciri (tune modu için düşük güç) ve harici HF/6m telsiz (operasyon modu, yüksek güç) arasında antene giden yolu seçmek.

Temel Sorun:
    Mevcut diyagramda antene sadece iç zincir (AD9851 → RF Amp → Attenuator → SWR Bridge → Loop) gider. Harici TRX girişi yok.

Çözüm Mimarisi (İki Mod):
    1. TUNE MODU (Düşük güç): Kaynak = AD9851 zinciri. Telsiz devreden izole.
    2. OPERATE MODU (Yüksek güç): Kaynak = Harici TRX. İç DDS zinciri anten hattından röle ile ayrılır.

Gerekli Ek Bileşenler:
    • RF Seçim Rölesi (SPDT veya DPDT, HF 0–60 MHz, örn. 100W max) veya Koaksiyel RF Rölesi.
    • (Opsiyonel) İkinci Röle: Attenuator / DDS zincirini tamamen ayırmak veya TRX gücünde köprülemek.
    • Harici TRX konnektörü: SO239 (PL-259), veya BNC/SMA (güce göre). Genellikle SO239 veya N-Type tercih edilir.
    • Yüksek Güç SWR Ölçümü için uygun bir SWR köprüsü (mevcut düşük güç versiyonu transceiver çıkış gücünü kaldıramayabilir!).

Basitleştirilmiş Blok Diyagram:
    ┌──────────┐        ┌──────────────┐        ┌─────────────┐        ┌──────────┐
    │ Harici   │        │  RF Seçim    │ TUNE→  │  DDS Zinciri │        │  Loop     │
    │  TRX     │─►COAX─►│  Rölesi (R1) │───────►│(Amp+Atten+   │─►SWR──►│ Anteni    │
    │ (TX/RX)  │        │   Ortak)     │        │  SWR Bridge) │        │          │
    └──────────┘        │              │        └─────────────┘        └──────────┘
           ▲            │              │ OPERATE                                    
           │            │              │ MODE→ ───────────────► (Yüksek Güç SWR / Direkt Besleme) ─► Loop
           │            └──────────────┘

Omron G5RV-2-12V (DPDT) Bağlantı Detayı:
    • Tip: DPDT röle, iki ayrı kontak seti (A ve B). Her sette COM, NO, NC uçları.
    • Kullanım: Bir seti sinyal merkez iletken için, diğer seti koaks kalkan/şase anahtarlamak için kullan.

    Kontak A (Merkez İletken):
        COM  ──► Anten besleme hattı (SWR Bridge INPUT veya vakum kapasitör besleme)
        NO   ──► Harici TRX merkez (SO239 center pin)
        NC   ──► DDS zinciri merkez (Attenuator OUT)

    Kontak B (Kalkan/Şase):
        COM  ──► Anten koaks kalkanı/şase (loop besleme noktası şasesi)
        NO   ──► Harici TRX koaks kalkanı
        NC   ──► DDS zinciri koaks kalkanı

    Bobin Bağlantısı:
        • Röle bobini: 12V. Bir ucu +12V, diğer ucu NPN sürücü üzerinden GND’ye.
        • Arduino Pin (ör. Pin 11 → RF_MODE) → NPN baz direnci (10k) → NPN (2N2222). Kolektör röle bobin ucuna, emiter GND.
        • Bobin üzerine ters paralel diyot (1N4148/1N4007) ekle (flyback).
        • Mantık: RF_MODE HIGH → NPN iletken → röle çeker → NO devrede (OPERATE). RF_MODE LOW → röle bırakırsın → NC devrede (TUNE).

    Kablolama Notları:
        • Koaks merkez hatları için mümkün olan en kısa hat; kalkanı 360° şaseye bağla.
        • DPDT kullanımı ile kalkanlar da anahtarlanarak sızıntı/loop’lar azaltılır.
        • Röleyi anten besleme noktasına yakın monte et; geniş bakır şase kullan.

    Güvenlik:
        • Geçiş sırasında TX yapma.
        • Tune modunda TRX çıkış verme (PTT kilidi önerilir).

Detaylı Röle Konfigürasyonu (Örnek SPDT):
    • Ortak (COM): Antene giden hat (SWR Bridge çıkışı veya doğrudan Vakum Kapasitör besleme noktası).
    • KONTAK 1 (TUNE): DDS zinciri çıkışı (Attenuator sonrası düşük güç).
    • KONTAK 2 (OPERATE): Harici TRX çıkışı.
    • Röle bobini Arduino tarafından kontrol (ayrı dijital pin, örn. Pin 11 → RF_MODE). HIGH = Operate, LOW = Tune.

Güç Notları:
    • Mevcut T50-2 tabanlı SWR Bridge sadece düşük güce uygun (mW seviyeleri). Transceiver’de (ör. 50W) kullanmak istiyorsan: Daha büyük toroid (ör. FT82-43) ve uygun direnç ağıyla yüksek güç SWR köprüsü tasarla.
    • Alternatif: Tune modunda düşük güç iç sinyal kullan, optimum kapasitör ayarını bul, sonra röleyi OPERATE’a geçir ve transceiver ile çalış. Bu durumda düşük güç SWR Bridge anten hattından ayrılabilir veya paralel kalabilir (uygun izolatör ekle).

Kablolama Önerisi:
    Harici TRX Konnektörü (SO239):
        SO239 Merkez ──► Röle KONTAK 2
        SO239 Şase  ───► Ortak GND / Kutu

    DDS Zinciri Çıkışı (Attenuator OUT):
        Merkez ─────────► Röle KONTAK 1
        Shield ─────────► GND (aynı kablo kalkanı)

    Röle COM:
        Merkez ─────────► Mevcut SWR Bridge INPUT (veya güç SWR köprüsü giriş noktası)

Arduino Kontrol (Yeni Pin Örneği):
    Pin 11 (RF_MODE) → Röle IN (aktif LOW/HIGH modüle göre)
    Kod mantığı:
        Tune Modu: RF_MODE = LOW → Röle TUNE kontak (DDS) bağlı
        Operate Modu: RF_MODE = HIGH → Röle OPERATE kontak (TRX) bağlı

Koruma / Güvenlik:
    • Tune modunda TRX kesinlikle RF çıkış yapmamalı (PTT kilidi veya kullanıcı uyarısı).
    • Röle geçişi sırasında TX yapma (ark oluşumu / kontak zarar riski).
    • Yüksek güç için koaksiyel röle veya düşük kayıplı HF güç rölesi seç.
    • Ortak GND ve şase düşük empedanslı olmalı (geniş bakır yüzey / şerit).

Opsiyonel Gelişmiş Yöntem (Yönlü Kuplör Enjeksiyonu):
    • DDS düşük güç sinyali harici TRX hattına yönlü kuplör üzerinden enjekte edilir (Coupler -20dB port).
    • Böylece fiziksel kaynak seçme rölesi gerekmez; DDS sadece test anlarında kısa süre besler.
    • Kuplör portu izolasyon: >30dB; TRX yüksek gücü DDS zincirine geri yansımaz.

Basitlik İçin Sonuç:
    • İlk uygulamada tek SPDT RF rölesi + harici SO239 konnektörü ekle.
    • Tune: Röle iç zinciri antene bağlar.
    • Operate: Röle harici TRX’i antene bağlar, iç zincir izole olur.

Not Ekleme (MONTAJ SIRASI Bölümüne):
    ADIM 8 (Opsiyonel): Harici TRX rölesi ve konnektörü montajı, fonksiyon testi.


╔═════════════════════════════════════════════════════════════════════════════╗
║                    MONTAJ SIRASINDAKİ BAĞLANTI DÜZENİ                        ║
╚═════════════════════════════════════════════════════════════════════════════╝

ADIM 1: Güç Dağıtımı
    ✓ Ground bus oluştur (bakır şerit veya kalın tel)
    ✓ 12V PSU → RF Amp bağla
    ✓ 5V PSU → Arduino bağla
    ✓ Tüm GND'leri ortak bus'a bağla
    ✓ TEST: Multimetre ile voltajları kontrol et

ADIM 2: DDS Bağlantısı
    ✓ AD9850 VCC → Arduino 5V
    ✓ AD9850 GND → Arduino GND
    ✓ AD9850 FQ_UD → Arduino Pin 53
    ✓ AD9850 W_CLK → Arduino Pin 52
    ✓ AD9850 DATA  → Arduino Pin 51
    ✓ AD9850 RESET → Arduino Pin 49
    ✓ TEST: Kodu yükle, frekans ayarla

ADIM 3: RF Zinciri + Röle Modülü
    ✓ Röle VCC → Arduino 5V
    ✓ Röle GND → Arduino GND
    ✓ Röle IN  → Arduino Pin 10
    ✓ 12V PSU → Röle COM
    ✓ Röle NO  → RF Amp VCC
    ✓ RF Amp GND → Ortak GND
    ✓ AD9850 SMA Dişi → SMA Erkek-Erkek kablo → RF Amp RFIN
    ✓ (Alternatif: SINE OUT pin → jumper kablo → RF Amp RFIN)
    ✓ RF Amp RFOUT → Attenuator (koax)
    ✓ Attenuator → SWR Bridge (koax)
    ✓ TEST: Serial'den R komutu → Röle tik sesi duyulmalı

ADIM 4: SWR Bridge Montajı
    ✓ T50-2 toroid sarımı yap (ASSEMBLY.md'ye göre)
    ✓ FWD sample → AD8307 #1
    ✓ REF sample → AD8307 #2
    ✓ AD8307 OUT'ları → A0, A1
    ✓ TEST: Dummy load ile SWR ölç

ADIM 5: Motor Sistemi
    ✓ TB6600 güç bağlantıları (24V motor PSU)
    ✓ Pin 4,3,9 → TB6600
    ✓ TB6600 → Step Motor (4 tel)
    ✓ Motor → Kapasitör mekanik bağlantı
    ✓ TEST: Manuel motor hareketi

ADIM 6: Kullanıcı Arayüzü
    ✓ Encoder bağla (CLK, DT, SW)
    ✓ Butonları bağla (Pin 7, 8)
    ✓ TEST: Serial Monitor'den komutlar

ADIM 7: Final Test
    ✓ Tüm voltajları ölç
    ✓ RF zincirini kontrol et
    ✓ Otomatik tune testi (T7.100)
    ✓ SWR değerlerini gözlemle


╔═════════════════════════════════════════════════════════════════════════════╗
║                         EMI/RF KORUMA ÖNLEMLERİ                              ║
╚═════════════════════════════════════════════════════════════════════════════╝

1. RF Kabloların Kalkanlanması:
    • Tüm RF kablolar koaksiyel olmalı (shield'li)
    • Shield'ler her iki uçta da GND'ye bağlanmalı
    • Kablo uzunlukları minimum tutulmalı

2. Ground Plane:
    • Metal şase veya bakır ground plane kullan
    • Tüm modüllerin GND'leri tek noktadan bağlansın (star topology)
    • RF ground ile dijital ground ortak olsun

3. Güç Filtreleme:
    • Her modülün VCC girişine 100nF seramik kondansatör
    • RF Amp gücüne 100uF elektrolitik + 100nF seramik
    • AD9851'e 10uF + 100nF + 10nF (3'lü)

4. Fiziksel Yerleşim:
    • RF modüller bir tarafta (AD9851, Amp, SWR Bridge)
    • Dijital modüller diğer tarafta (Arduino, TB6600)
    • AD8307'ler RF kaynağından uzak
    • Motor sürücüsü Arduino'dan uzak

5. Kablo Düzeni:
    • RF kabloları ve dijital kabloları çaprazlamayın
    • Motor kabloları twist edilmeli (EMI azaltma)
    • Uzun paralel kablolardan kaçının

6. Metal Kutu:
    • Tüm sistem metal kutuda olmalı
    • Kutu GND'ye bağlanmalı
    • RF çıkışı için SO239 panel mount
    • Havalandırma delikleri (RF Amp için)


╔═════════════════════════════════════════════════════════════════════════════╗
║                              ÖNEMLİ NOTLAR                                   ║
╚═════════════════════════════════════════════════════════════════════════════╝

⚠️  GÜVENLİK:
    • İlk açılışta RF Amp gücünü KAPALI tut
    • Röle kullanıyorsan yazılımdan kontrol et
    • Test sırasında dummy load kullan
    • RF Amp'e soğutma sağla (heatsink veya fan)
    • Motor hareket ederken elleri uzak tut

⚠️  ELEKTRİK:
    • Polariteye dikkat (12V ters bağlama!)
    • Ortak GND şart (ground loop problemi)
    • Güç kaynakları yeterli akım sağlamalı

⚠️  RF:
    • AD9851 frekans aralığı: 0–60+ MHz (HF komple + 6 m)
    • 50Ω empedans uyumu kritik
    • SMA konnektörler sıkıca takılmalı
    • Uzun RF kablolarında kayıp artar
    • SWR >3:1 ise sistemi durdur

⚠️  YAZILIM:
    • İlk kullanımda kalibrasyonu yap
    • SWR eşik değerlerini ayarla
    • Motor limitlerini belirle (step counter)
    • Seri monitörden logları takip et


╔═════════════════════════════════════════════════════════════════════════════╗
║                         SİSTEM TEST PROSEDÜRÜ                                ║
╚═════════════════════════════════════════════════════════════════════════════╝

1. GÜÇ TESTİ:
   □ 5V tüm modüllerde var mı?
   □ 12V RF Amp'te var mı?
   □ GND ortak mu?

2. DDS TESTİ:
   □ Serial'den F7.100 komutunu gönder
   □ Osiloskop probu:
        • SMA çıkışına (BNC→SMA adaptör ile), VEYA
        • SINE OUT pinine (direkt prob)
    □ Beklenen: 7.100 MHz sinüs (seviye modüle bağlı)
   □ Frekans counter ile doğrula

3. RF AMP + RÖLE TESTİ:
   □ Röle bağlantılarını kontrol et
   □ Serial'den R komutu gönder
   □ Röle "tik" sesi duyulmalı (mekanik röle)
   □ Röle LED'i yanmalı (varsa)
   □ RF Amp'e 12V güç gelmeli (multimetre ile ölç)
   □ RF probe ile RFOUT'u ölç (~1W çıkış beklenir)
   □ Attenuator sonrası ~10mW olmalı

4. SWR TESTİ:
   □ Dummy load tak
   □ Serial'den M (SWR ölç)
   □ SWR ~1.0-1.2 olmalı (ideal match)

5. MOTOR TESTİ:
   □ Buton 7'ye bas → Motor ileri dönmeli
   □ Buton 8'e bas → Motor geri dönmeli
   □ Encoder çevir → Step sayısı değişmeli

6. OTOMATİK TUNE TESTİ:
   □ Gerçek anten bağla
   □ Serial'den T7.100
   □ Motor otomatik dönmeli
   □ SWR minimize olmalı (<1.5)

7. BAND SWEEP TESTİ:
   □ Serial'den SWEEP 7.0 7.3
   □ Tüm frekanslarda SWR ölçülmeli
   □ En düşük SWR frekansı bulunmalı


═══════════════════════════════════════════════════════════════════════════════
                          SİSTEM HAZIR! 🎉
═══════════════════════════════════════════════════════════════════════════════
```
